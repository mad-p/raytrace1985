# SLDファイル形式仕様

1985年版レイトレーシングプログラムで使用されるシーン記述ファイル（.sld）の形式

## ファイル構造概要

SLDファイルは以下のセクションから構成される：

1. **カメラ設定**
2. **ライト設定** 
3. **プリミティブ定義**
4. **範囲プリミティブ定義**
5. **ANDリスト定義**
6. **ネットワーク定義**

各セクションは255で終端される。

## 詳細仕様

### 1. カメラ設定

```
<viewpoint_depth>
<screen_x> <screen_y> <screen_z>   <alpha> <beta>
<light_alpha> <light_beta>
```

- **viewpoint_depth**: 視点の奥行き（負の値）
- **screen_x/y/z**: スクリーン位置座標
- **alpha/beta**: スクリーン回転角（度）
- **light_alpha/beta**: 光源方向角（度）

### 2. プリミティブ定義

```
<kind> <texture> <bump> <surface> <rotation> <param_x> <param_y> <param_z> <offset_x> <offset_y> <offset_z> <sgn> <highlight> <color_r> <color_g> <color_b> [<rotation_x> <rotation_y> <rotation_z>] <network_sh> <network_ru> <network_rd> <network_lu> <network_ld>
```

#### パラメータ説明：

- **kind**: プリミティブ種類
  - 1: CUBE（立方体）
  - 2: PLANE（平面）
  - 3: SECOND（二次曲面）
  - 4: CONE（円錐）

- **texture**: テクスチャ種類（0=なし、1～5=標準テクスチャ）
- **bump**: バンプマッピング種類（0=なし）
- **surface**: 表面材質
  - 0: 通常反射
  - 1: 不透明
  - 2: 鏡面
  - 3: 透明（屈折）
  - 4以上: 光源

- **rotation**: 回転の有無（0/1）
- **param_x/y/z**: 形状パラメータ（立方体なら半辺長、平面なら法線ベクトル）
- **offset_x/y/z**: 位置オフセット
- **sgn**: 内外判定の符号（1/-1）
- **highlight**: ハイライト強度
- **color_r/g/b**: 色成分（0-255または0-1.0）
- **rotation_x/y/z**: 回転角（rotation=1の場合のみ）
- **network_****: 各象限でのネットワーク参照

### 3. 範囲プリミティブ定義

```
<range_id> <center_x> <center_y> <center_z> <radius>
```

効率化のための空間分割に使用される球状範囲。

### 4. ANDリスト定義

```
<primitive_id> [<primitive_id> ...] 255
```

複数のプリミティブの論理積（共通部分）を定義。

### 5. ネットワーク定義

```
<range_id> <andlist_id> [<andlist_id> ...] 255
```

範囲プリミティブ内でのオブジェクト群（ORリスト）を定義。

## 実例解析

### kenda.sld（簡単な構成例）
- 視点: 奥行き-200
- スクリーン位置: (-35, 0, -50)、回転: (0°, -30°)
- 7個のプリミティブ（主に二次曲面）
- 3個の範囲プリミティブ
- 3個のネットワーク

### obje.sld（中程度の複雑さ）
- 8個のプリミティブ（二次曲面、立方体、平面）
- 異なる表面材質（不透明、鏡面、通常）
- 色付きオブジェクト

### latice2.sld（複雑な構成例）
- 24個のプリミティブ（格子状配置）
- 回転を含む複雑な配置
- 複数の範囲プリミティブと階層的ネットワーク

## 座標系

- 右手座標系
- Y軸が上方向
- 角度は度単位で指定
- 距離・座標値は実数

## 注意事項

- コメントは`;`で開始
- 255は各セクションの終端マーカー
- 浮動小数点数は小数点記法または整数で記述
- 空行は無視される
